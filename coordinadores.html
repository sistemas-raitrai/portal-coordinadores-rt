<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>PORTAL COORDINADORES RAITRAI</title>
  <link rel="icon" type="image/png" href="RaitraiLogo.png" />

  <!-- CSS MOBILE-FIRST -->
  <style>
    :root{
      --bg:#0b1329;--panel:#0e1834;--line:#334155;--text:#e5e7eb;--muted:#94a3b8;
      --fs-base: clamp(15px, 3.8vw, 17px);
      --fs-sm:   clamp(13px, 3.2vw, 15px);
      --fs-meta: clamp(12px, 2.9vw, 14px);
      --fs-h3:   clamp(18px, 5.4vw, 24px);
      --fs-h4:   clamp(15px, 4.5vw, 19px);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;background:var(--bg);color:var(--text);
      font: var(--fs-base)/1.42 system-ui,Segoe UI,Roboto,Arial;
      -webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;
      text-transform: uppercase; /* ⬅️ TODO EN MAYÚSCULAS EN LA UI */
    }
    .wrap{width:100%;max-width:100%;margin:10px auto;padding:0 10px;display:grid;gap:10px}
    .panel{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:12px}
    .muted{color:var(--muted)}
    .meta{color:#cbd5e1;font-size:var(--fs-meta)}
    .btn{cursor:pointer;border-radius:12px;border:1px solid var(--line);padding:.7rem 1rem;min-height:44px;background:#0f1a38;color:var(--text);font-weight:600}
    .btn.ok{background:#155e75;border-color:#0e7490}
    .btn.warn{background:#7c2d12;border-color:#9a3412}

    select,input,textarea{
      background:#0b1329;color:var(--text);border:1px solid var(--line);border-radius:12px;
      padding:.6rem .8rem;font-size:inherit;min-height:44px;width:100%
    }
    select{appearance:none}

    /* NAV */
    #navBar{display:flex;gap:.6rem;align-items:center;flex-wrap:wrap}
    #navBar .btns{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;width:100%}
    #navBar .btns .btn{flex:1 1 48%}
    #btnPrintVch,#btnNewAlert{flex:1 1 48%}
    #allTrips{flex:1 1 100%}
    @media (min-width:720px){
      .wrap{max-width:1100px;padding:0 14px;gap:12px}
      #navBar .btns{width:auto}
      #navBar .btns .btn{flex:0 0 auto}
      #btnPrintVch,#btnNewAlert{flex:0 0 auto}
      #allTrips{flex:1 1 420px;max-width:620px}
    }

    /* GRUPO */
    .group-card{background:#0f1a38;border:1px solid var(--line);border-radius:12px;padding:12px}
    .group-card h3{margin:.15rem 0 .5rem;font-size:var(--fs-h3);font-weight:800}
    .grid-mini{display:grid;grid-template-columns:96px 1fr;gap:.45rem .8rem;margin-top:.4rem}
    @media (min-width:720px){ .grid-mini{grid-template-columns:120px 1fr} }
    .lab{color:#cbd5e1;font-size:var(--fs-sm);opacity:.9;letter-spacing:.02em}
    .rowflex{display:flex;gap:.6rem;align-items:center;flex-wrap:wrap}

    /* ITINERARIO */
    .date-pills{display:flex;gap:.35rem;flex-wrap:wrap;margin:.45rem 0}
    .pill{border:1px solid var(--line);border-radius:999px;padding:.35rem .9rem;cursor:pointer;white-space:nowrap}
    .pill.active{background:#1e293b}
    .acts{display:grid;gap:.9rem}
    .act{border:1px dashed var(--line);border-radius:10px;padding:.7rem}
    h4{font-size:var(--fs-h4);margin:.1rem 0 .5rem}

    /* TABLAS */
    table.table{width:100%;border-collapse:collapse;display:block;overflow-x:auto;-webkit-overflow-scrolling:touch}
    table.table thead,table.table tbody{display:table;width:100%;table-layout:fixed}
    table.table th,table.table td{border-top:1px solid var(--line);padding:.55rem .4rem;text-align:left;white-space:nowrap;font-size:var(--fs-sm)}
    .totline{margin-top:.6rem;font-weight:700}

    /* TABLAS RESPONSIVE (ESPECIALMENTE PARA GASTOS) */
    @media (max-width: 680px){
      table.table{display:block;border:0;overflow:visible}
      table.table thead{display:none}
      table.table tbody{display:block}
      table.table tr{
        display:grid;
        grid-template-columns: 1fr;
        gap:.35rem;
        padding:.6rem .2rem;
        border-top:1px solid var(--line);
      }
      table.table td{
        display:flex;
        gap:.6rem;
        align-items:center;
        white-space:normal;          /* EVITA SUPERPOSICIÓN */
        word-break:break-word;
      }
      table.table td::before{
        content: attr(data-label);
        min-width:120px;             /* ANCHO DE ETIQUETA */
        font-weight:700;
        color:#cbd5e1;
      }
      /* QUE LA LÍNEA DE TOTALES TAMBIÉN SE AJUSTE */
      .totline{white-space:normal; line-height:1.35}
    }

    /* LINKS EN TABLAS/TARJETAS (EJ: COMPROBANTE EN GASTOS) */
    :root{
      --link: #ffffff;         /* BLANCO */
      --link-hover: #f1f5f9;   /* UN POCO MÁS CLARO AL PASAR */
      --link-visited: #cbd5e1; /* GRIS SUAVE DESPUÉS DE ABRIR */
    }
    
    table.table a,
    .act a{
      color: var(--link);
      text-decoration: underline;
      text-underline-offset: 2px;
    }
    
    table.table a:hover,
    table.table a:focus,
    .act a:hover,
    .act a:focus{
      color: var(--link-hover);
    }
    
    table.table a:visited,
    .act a:visited{
      color: var(--link-visited);
    }
    
    /* MEJOR ACCESIBILIDAD AL ENFOQUE CON TECLADO */
    table.table a:focus-visible,
    .act a:focus-visible{
      outline: 2px solid #e2e8f0;
      outline-offset: 2px;
    } 

    /* MODAL */
    #modalBack{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;padding:14px;z-index:999}
    #modalDialog{max-width:720px;width:100%;background:#0f1a38;border:1px solid var(--line);border-radius:12px}
    #modalHead{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--line);padding:10px 12px}
    #modalBody{padding:12px}
    #modalTitle{font-weight:800;font-size:var(--fs-h4)}

    /* STATS MÁS GRANDES EN DESKTOP */
    #statsPanel .meta{font-size:clamp(13px,3.4vw,15px)}
    @media (min-width:900px){ #statsPanel{max-width:820px;margin-inline:auto} }

    /* ALERTAS */
    .tabs{display:flex;gap:.4rem;flex-wrap:wrap}
    .tab{border:1px solid var(--line);padding:.4rem .8rem;border-radius:999px;cursor:pointer}
    .tab.active{background:#1e293b}
    .alert-card{border:1px solid var(--line);border-radius:12px;padding:10px;background:#0f1a38}
    .alert-title{font-weight:700;margin:.2rem 0 .35rem}
    
    /* CABECERA DE ALERTAS: TÍTULO + PASTILLAS SUTILES AL LADO */
    .alert-head{display:flex;align-items:center;justify-content:space-between;gap:.6rem;flex-wrap:wrap}
    .alert-title-row{display:flex;align-items:center;gap:.5rem}
    
    /* BADGE (ÚNICA DEFINICIÓN — SUTIL) */
    .badge{
      display:inline-block;
      min-width:1.5em;
      padding:.05rem .45rem;
      border-radius:999px;
      background:#475569;
      color:#e5e7eb;
      font-weight:800;
      font-size:var(--fs-meta);
    }
    
    /* PASTILLAS SUTILES DE ÁMBITO (DISTINTAS A NO LEÍDAS/LEÍDAS) */
    .scope-chips{display:flex;gap:.35rem;align-items:center;flex-wrap:wrap}
    .scope-chip{
      border:1px solid var(--line);
      background:transparent;
      color:var(--text);
      padding:.28rem .7rem;
      border-radius:999px;
      cursor:pointer;
      font-size:var(--fs-sm);
      opacity:.9;
    }
    .scope-chip:hover{background:#13203a}
    .scope-chip.active{background:#16213d;opacity:1}
    .scope-chip .badge{background:#64748b}
    
    /* OPCIONAL: SEPARADOR SUAVE ENTRE TARJETAS */
    .alert-sep{border-top:1px dashed var(--line);opacity:.55;margin:.6rem 0}

    /* ESPACIOS EN EL PANEL DE ALERTAS */
    #alertsPanel .alert-head{
      margin-bottom: .55rem;        /* SEPARA EL TÍTULO "ALERTAS" DE LAS TABS */
    }
    
    #alertsPanel .tabs{
      margin: .25rem 0 .75rem;      /* AIRE POR ENCIMA Y DEBAJO DE "NO LEÍDAS / LEÍDAS" */
    }
    
    #alertsPanel .alert-card{
      margin-bottom: .70rem;        /* ESPACIO ENTRE TARJETAS/CONTENEDORES */
    }
    
    /* SI TU H4 DE TÍTULO ESTÁ DENTRO DE .alert-head, APLANA SUS MÁRGENES */
    #alertsPanel .alert-head h4{ margin: 0; }

    /* =========================
   STATS — ancho y layout
   ========================= */

    /* Contenedor: usa todo el ancho en todas las vistas */
    #statsPanel .stats-wrap{
      max-width: none;   /* antes: 980px */
      width: 100%;
      margin-inline: 0;  /* antes: auto */
    }
    
    /* Móvil: los ítems van apilados */
    #statsPanel .meta-line{
      display: grid;
      gap: .35rem;
    }
    
    /* Ítems: permiten romper línea si hace falta */
    #statsPanel .meta-line .item{
      white-space: normal;
      min-width: 0;
      overflow-wrap: anywhere;  /* por si hay destinos muy largos */
    }
    
    /* (Opcional) Forzar no-salto en ítems cortos */
    #statsPanel .meta-line .item.nowrap{ white-space: nowrap; }
    
    /* (Opcional) Dar más peso al prefijo, si lo usas */
    #statsPanel .meta-line .item.prefix{ font-weight: 800; }
    
    /* Escritorio: no achicar el panel y formar una línea (envolviendo si no cabe) */
    @media (min-width: 900px){
      #statsPanel{
        max-width: none;   /* antes: 820px */
        margin-inline: 0;
      }
    
      #statsPanel .meta-line{
        display: flex;
        flex-wrap: wrap;         /* mantiene el texto dentro del panel */
        align-items: baseline;
        gap: .6rem 1.2rem;
      }
    
      /* Separadores en desktop (no se añade al último) */
      #statsPanel .meta-line .item:not(:last-child)::after{
        content: " ·";
        margin-left: .6rem;
        opacity: .75;
      }
      .btn.ok { background:#16a34a; color:#fff; }
      .btn.gray { background:#64748b; color:#fff; }
    }

    /* ===== IMPRESIÓN TEXTUAL SIMPLE ===== */
    @media screen { 
      #print-block { display: none; }
    }
    @media print {
      /* Oculta todo menos el bloque de impresión */
      body > *:not(#print-block) { display: none !important; }
    
      #print-block{
        display:block !important;
        white-space:pre-wrap;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
        font-size: 12pt;
        line-height: 1.35;
        margin: 0;
        padding: 0;
      }
      @page { margin: 16mm; }
    }   
  </style>
</head>
<body>
  <div class="wrap">
    <div id="staffBar" class="panel"></div>

    <!-- PANEL DE ALERTAS (CON CONTADORES Y AUTO-REFRESCO) -->
    <div id="alertsPanel" class="panel"></div>

    <div id="navPanel" class="panel">
      <div id="navBar">
        <div class="btns">
          <button id="btnPrev" class="btn sec">‹ ANTERIOR</button>
          <button id="btnNext" class="btn sec">SIGUIENTE ›</button>
          <button id="btnPrintVch" class="btn sec" style="display:none">IMPRIMIR VOUCHERS</button>
          <button id="btnNewAlert" class="btn sec" style="display:none">CREAR ALERTA</button>
        </div>
        <select id="allTrips"></select>
      </div>
    </div>

    <div id="statsPanel" class="panel"></div>

    <div id="gruposPanel" class="panel">
      <div id="grupos"></div>
    </div>
  </div>

  <!-- MODAL GLOBAL -->
  <div id="modalBack">
    <div id="modalDialog">
      <div id="modalHead">
        <div id="modalTitle">TÍTULO</div>
        <button id="modalClose" class="btn sec">✕</button>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>

  <script type="module" src="./coordinadores.js"></script>
  <!-- Bloque de texto que solo aparece al imprimir -->
  <pre id="print-block"></pre>
</body>
</html>
